<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Crop Production â€” Dowson Farms</title>
  <base href="../"/>
  <link rel="stylesheet" href="assets/css/theme.css"/>
</head>
<body>

  <!-- Header -->
  <header class="app-header">
    <div class="logo"><img src="assets/icons/logo.png" alt="Dowson Farms"></div>
    <div class="title">Crop Production</div>
    <div class="spacer"><span id="df-clock"></span></div>
  </header>

  <!-- Breadcrumbs -->
  <nav class="breadcrumbs">
    <button id="hamburger" class="hamburger" aria-label="Open menu">â˜°</button>
    <ol id="crumbs">
      <li><a href="index.html">Home</a></li>
      <li class="sep">â€º</li>
      <li><span>Crop Production</span></li>
    </ol>
    <button class="logout-btn" id="logout">Logout</button>
  </nav>

  <!-- Drawer + backdrop -->
  <aside id="drawer" class="drawer" aria-label="Navigation">
    <div class="drawer-hd">Menu</div>
    <ul id="nav" class="nav"></ul>
  </aside>
  <div id="backdrop" class="backdrop"></div>

  <!-- Content -->
  <main class="content">
    <h1>Operations</h1>
    <p class="subtle">Keep â€œAddâ€ and â€œViewâ€ separate so the page stays uncluttered.</p>

    <section class="card">
      <h2>Add Data</h2>
      <div class="row">
        <a class="btn" href="crop-production/crop-planting.html">ğŸŒ± Add Planting</a>
        <a class="btn" href="crop-production/crop-spraying.html">ğŸ’¦ Add Spraying</a>
        <a class="btn" href="crop-production/crop-aerial.html">ğŸš Add Aerial Spraying</a>
        <a class="btn" href="crop-production/crop-harvest.html">ğŸŒ¾ Add Harvest</a>
        <a class="btn" href="crop-production/crop-fertilizer.html">ğŸ§ª Add Fertilizer</a>
        <a class="btn" href="crop-production/crop-scouting.html">ğŸ” Add Scouting</a>
        <a class="btn" href="crop-production/crop-maintenance.html">ğŸ› ï¸ Add Maintenance</a>
        <a class="btn" href="crop-production/crop-trials.html">ğŸ§¬ Add Trial</a>
      </div>
    </section>

    <section class="card">
      <h2>View / Analyze</h2>
      <div class="row">
        <a class="btn" href="reports/reports-predefined.html">ğŸ“ Pre-Defined Reports</a>
        <a class="btn" href="reports/reports-ai.html">ğŸ¤– AI Reports</a>
        <a class="btn" href="reports/reports-ai-history.html">ğŸ•˜ Report History</a>
        <a class="btn" href="crop-production/crop-planting.html#history">ğŸŒ± Planting History</a>
        <a class="btn" href="crop-production/crop-spraying.html#history">ğŸ’¦ Spraying History</a>
        <a class="btn" href="crop-production/crop-harvest.html#history">ğŸŒ¾ Harvest History</a>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="app-footer">
    <span id="version">v0.0.0</span><span>â€¢</span><span id="df-date-footer"></span>
  </footer>

  <!-- Data + core -->
  <script src="assets/data/menus.js"></script>
  <script src="js/core.js"></script>

  <!-- Page wiring -->
  <script>
  (function(){
    'use strict';

    /* Drawer toggle */
    const drawer = document.getElementById('drawer');
    const backdrop = document.getElementById('backdrop');
    const btn = document.getElementById('hamburger');
    function open(){ drawer.classList.add('open'); backdrop.classList.add('show'); }
    function close(){ drawer.classList.remove('open'); backdrop.classList.remove('show'); }
    function toggle(){ drawer.classList.contains('open') ? close() : open(); }
    btn.addEventListener('click', toggle);
    backdrop.addEventListener('click', close);
    window.addEventListener('keydown', e=>{ if(e.key==='Escape') close(); });

    /* Build drawer */
    const nav = document.getElementById('nav');
    const menus = (window.DF_MENUS && Array.isArray(window.DF_MENUS.tiles)) ? window.DF_MENUS.tiles : [];
    nav.innerHTML='';
    menus.forEach(sec=>{
      const li=document.createElement('li');
      const b=document.createElement('button');
      b.className='section-btn'; b.setAttribute('aria-expanded','false');
      b.innerHTML=`<span class="section-ico">${sec.iconEmoji||'ğŸ“'}</span><span>${sec.label||''}</span><span class="chev">â€º</span>`;
      const sub=document.createElement('div'); sub.className='sub';
      (sec.children||[]).forEach(ch=>{
        const a=document.createElement('a'); a.href=ch.href||'#'; a.textContent=`${ch.iconEmoji||''} ${ch.label||''}`;
        sub.appendChild(a);
      });
      b.addEventListener('click',(e)=>{
        if (e.target.classList.contains('chev')) {
          const o=sub.classList.toggle('open'); b.setAttribute('aria-expanded', o ? 'true':'false');
        } else if (sec.href) {
          location.href = sec.href;
        }
      });
      li.appendChild(b); if ((sec.children||[]).length) li.appendChild(sub);
      nav.appendChild(li);
    });

    /* Time (header) + Date (footer) */
    const clockEl = document.getElementById('df-clock');
    const dateFoot = document.getElementById('df-date-footer');
    const tz = 'America/Chicago';
    function renderNow(){
      const now = new Date();
      if (clockEl) clockEl.textContent = now.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true,timeZone:tz});
      if (dateFoot) dateFoot.textContent = now.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'2-digit',year:'numeric',timeZone:tz});
    }
    renderNow(); const n=new Date(); const ms=(60-n.getSeconds())*1000-n.getMilliseconds();
    setTimeout(()=>{ renderNow(); setInterval(renderNow, 60000); }, Math.max(0, ms));

    /* Logout (use core if present) */
    const lg=document.getElementById('logout');
    if (lg) lg.addEventListener('click', e=>{
      e.preventDefault();
      if (window.handleLogout) return handleLogout(e);
      if (window.DF_UI?.logout) return DF_UI.logout(e);
      location.href = (document.querySelector('base')?.href || './') + 'auth/';
    });
  })();
  </script>
</body>
</html>